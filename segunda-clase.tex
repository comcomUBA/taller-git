\begin{frame}[t]{Otros comandos Ãºtiles}
    \begin{comando}
        git rm
    \end{comando}

    \uncover<2->{
        \begin{block}{}
            Permite borrar un archivo y marcar este cambio como \textit{staged}. La sintaxis es \texttt{git rm [archivo]}.
        \end{block}
    }

    \vspace{2em}

    \begin{comando}
        git mv
    \end{comando}

    \uncover<3->{
        \begin{block}{}
            Permite mover/renombrar un archivo y marcar este cambio como \textit{staged}. La sintaxis es \texttt{git mv [archivo] [nuevo nombre/ubicaciÃ³n]}.
        \end{block}
    }
\end{frame}

\begin{frame}[t]{Inspeccionando los cambios}
    \begin{comando}
        git diff
    \end{comando}

    \pause
    \begin{block}{}
        Muchas veces es conveniente ver cuÃ¡les son los cambios realizados antes de pasarlos a \textit{staged}.

        \vspace{.4em}

        Para esto tenemos el comando \texttt{git diff}, que muestra las diferencias entre
        el estado actual de los archivos y la Ãºltima vez que hicimos \texttt{git add}
        (cambios marcados como \textit{staged}).

        \vspace{.4em}

        Si, en cambio, queremos ver las diferencias entre los cambios marcados como \textit{staged} y los
        que confirmamos en el Ãºltimo \textit{commit}, podemos usar \texttt{git diff --staged}.
    \end{block}

    \pause
    \begin{ejercicio}{Ejercicio}
        Modificar un archivo de algÃºn repo de la clase pasada y ejecutar \texttt{git diff}.
    \end{ejercicio}
\end{frame}

\begin{frame}[t]{Viendo la historia de los \textit{commits}}
    \begin{comando}
        git log
    \end{comando}

    \pause
    \begin{block}{}
        DespuÃ©s de haber hecho varios \textit{commits}, o si acabamos de clonar un repositorio
        de Internet, puede que queramos ver el historial de \textit{commits} para saber cuÃ¡les
        son las modificaciones que se hicieron. Esto se puede lograr utilizando el
        comando \texttt{git log}.
    \end{block}

    \pause
    \begin{ejercicio}{Ejercicio}
        Ejecutar \texttt{git log} en algÃºn repo de la clase pasada.
    \end{ejercicio}
\end{frame}

\begin{frame}[t]{Ramificaciones en Git}

    % Git es distribuido

    Una \textbf{rama} (o \textit{branch}) en Git representa una lÃ­nea independiente de desarrollo.
    Al crear nuevas ramas, podemos pensar que nuestro proyecto diverge en dos distintos:
    los cambios que hagamos en uno no impactan al otro.

    \pause
    \vspace{0.5em}
    Un ejemplo visual:

    \begin{figure}[ht]
        \begin{center}
            \includegraphics[height=1.5in]{images/branch.pdf}
        \end{center}
    \end{figure}

    % \only<3-3>{
    %     \begin{figure}[ht]
    %         \begin{center}
    %             \includegraphics[height=1.5in]{images/branch-1.png}
    %         \end{center}
    %         \caption{La rama ``master'' apunta al commit \textit{f30ab}}
    %     \end{figure}
    % }
    %
    % \only<4-4>{
    %     \begin{figure}[ht]
    %         \begin{center}
    %             \includegraphics[height=1.5in]{images/branch-2.png}
    %         \end{center}
    %         \caption{Creamos una nueva rama llamada ``testing''}
    %     \end{figure}
    % }


    % Ademas de tener ramas locales, podemos tenemos ramas remotas, que referencian al estado de ramas en tus repositorios remotos.
    % Si por ejemplo quisieramos saltar a la rama ``master'' en el repositorio remoto ``origin'' podrÃ­amos utilizar el comando \texttt{git checkout origin/master}.
    %
    % \vspace{1em}
    %
    % Nuestras ramas locales no sincronizan automaticamente con los repositorios remotos. Por esta razÃ³n, si tenemos una rama llamada ``master'' de forma local que
    % apunta a la rama remota ``origin/master'' podemos actualizarla parandonos en ``master'' y ejecutando \texttt{git pull origin master}.
    %
    % \vspace{1em}
    %
    % De forma anÃ¡loga, si queremos publicar cambios locales aun repositorio remoto, tenemos el comando \texttt{git push}. Si estamos parados en la rama ``master'':
    % \texttt{git push origin master}.

\end{frame}

\begin{frame}[t]{Creando ramas}
    \begin{comando}
        git branch
    \end{comando}

    \pause
    \begin{block}{}
        Para crear una rama nueva, podemos ejecutar \texttt{git branch [nombre de la rama]}.

        \vspace{.4em}

        NÃ³tese que este comando no nos mueve a la nueva rama, solo la crea.

        \vspace{.4em}

        Para ver las ramas de nuestro repositorio local, podemos ejecutar \texttt{git branch}.
    \end{block}

    \pause
    \begin{ejercicio}{Ejercicio}
        Crear una rama llamada ``prueba'' en algÃºn repo de la clase pasada.
    \end{ejercicio}

\end{frame}

\begin{frame}[t]{Cambiando de rama}
    \begin{comando}
        git checkout
    \end{comando}

    \pause
    \begin{block}{}
        Para cambiar de rama, podemos ejecutar \texttt{git checkout [nombre de la rama]}.
    \end{block}

    \pause
    \vspace{0.5em}
    Un ejemplo visual:
    \vspace{-1.6em}

    \only<3-3>{
        \begin{figure}[ht]
            \begin{center}
                \includegraphics[height=1.6in]{images/checkout-branch-0.pdf}
            \end{center}
            \caption{}
        \end{figure}
    }

    \only<4-4>{
        \begin{figure}[ht]
            \begin{center}
                \includegraphics[height=1.6in]{images/checkout-branch-1.pdf}
            \end{center}
            \caption{AcÃ¡ cambiamos a la rama ``testing'', ejecutando \texttt{git checkout testing}.}
        \end{figure}
    }

    \uncover<5-5>{
        \begin{figure}[ht]
            \begin{center}
                \includegraphics[height=1.6in]{images/checkout-branch-2.pdf}
            \end{center}
            \caption{Y los siguientes \textit{commits} serÃ¡n agregados a la rama ``testing''.}
        \end{figure}
    }

\end{frame}

\begin{frame}[t]{Fusionando ramas}
    \begin{comando}
        git merge
    \end{comando}

    \pause
    \only<2-2>{
        \begin{block}{}
            Nos permite fusionar las historias de dos ramas distintas (podrÃ­a haber conflictos).

            \vspace{.4em}

            La sintaxis es: \texttt{git merge [nombre de la rama a fusionar]}.

            \vspace{.4em}

            \textbf{Importante:} este comando fusiona la rama que le decimos
            \textbf{en la rama en la que estamos parados}.
        \end{block}
    }

    \pause
    Un ejemplo visual:
    \only<3-3> {
        \begin{figure}[ht]
            \begin{center}
                \includegraphics[height=1.5in]{images/merge-branch-0.pdf}
            \end{center}
            \caption{Antes del \textit{merge}.}
        \end{figure}
    }
    \only<4-4> {
        \begin{figure}[ht]
            \begin{center}
                \includegraphics[height=1.5in]{images/merge-branch-1.pdf}
            \end{center}
            \caption{DespuÃ©s de pararnos en la rama ``master'' (\texttt{git checkout master}) y haber fusionado la rama ``feature'' (\texttt{git merge feature}).}
        \end{figure}
    }
\end{frame}

\begin{frame}[t]{Â¡A practicar!}

    \pause
    \begin{block}{Pero antes de empezar...}
        Para hacer el siguiente ejercicio, vamos a trabajar con un \textbf{fork} de un repositorio.
        \pause\textit{Â¿Y eso?}

        \pause
        El concepto de \textit{fork} no es propio de Git. En el Ã¡mbito del desarrollo de software,
        el tÃ©rmino se refiere a un proyecto que surge a partir de otro, y adopta un curso de
        desarrollo independiente.

        \pause
        Los servidores de Git, como GitLab, nos permiten hacer \textit{fork} de proyectos. Al hacer
        esto creamos una copia de un repositorio ajeno en nuestra propia cuenta, sobre la cual
        podemos trabajar libremente. Los cambios que hagamos en nuestra copia \textbf{no} impactarÃ¡n
        en el repositorio original.
    \end{block}

    \pause
    \begin{center}
    \Large Ahora sÃ­...
    \end{center}
\end{frame}

\begin{frame}[t]{Â¡A practicar!}
    \begin{ejercicio}{Ejercicio de a 2 mÃ¡quinas (preferiblemente 2 personas): ðŸ‘¾ y ðŸ‘½}
        \begin{enumerate}\begin{scriptsize}
            \pause
            \item ðŸ‘½: Hacer un \textit{fork} en su cuenta de \href{https://www.gitlab.com}{GitLab}
            de este repositorio: \url{https://gitlab.com/talleres-comcom/taller-git-ejercicio2}, y darle permiso a ðŸ‘¾
            para hacer \textit{push}.
            \pause
            \item ðŸ‘¾ y ðŸ‘½: Obtener una copia local del repositorio de ðŸ‘½.
            \pause
            \item ðŸ‘¾ y ðŸ‘½: El repo tiene una Ãºnica rama, ``master'', donde van a encontrar la letra,
            incompleta, de \href{https://youtu.be/dDq0ne1xK3o}{una canciÃ³n}. Repartirse el trabajo:
            uno deberÃ¡ completar la parte A y el otro, la parte B.
            \pause
            \item ðŸ‘¾ y ðŸ‘½: Crear, cada uno, una rama propia donde harÃ¡n sus modificaciones. Posicionarse
            en la rama reciÃ©n creada.
            \pause
            \item ðŸ‘¾ y ðŸ‘½: Completar la parte elegida de la canciÃ³n, y hacer \textit{push} de estos
            cambios en el repositorio remoto.
            \pause
            \item ðŸ‘¾: Crear una nueva rama \textbf{a partir de ``master''}, y traerse (\textit{pull})
            a esta rama los cambios de ðŸ‘½.
            \pause
            \item ðŸ‘¾: Volver a su rama de trabajo y fusionar en ella los cambios de ðŸ‘½. Enviar estos
            cambios al repositorio remoto.
            \pause
            \item ðŸ‘½: Seguir los dos pasos anteriores, pero con los cambios de ðŸ‘¾.
        \end{scriptsize}\end{enumerate}
    \end{ejercicio}

\end{frame}

\begin{frame}[t]{Revirtiendo cambios}
    \begin{comando}
        git commit --amend
    \end{comando}

    \uncover<2->{
        \begin{block}{}
            Podemos usarlo para \textbf{arreglar}, por ejemplo, el mensaje del Ãºltimo \textit{commit} que hicimos: \texttt{git commit --amend -m [nuevo mensaje]}.
        \end{block}
    }

    \vspace{2em}

    \begin{comando}
        git revert
    \end{comando}

    \uncover<3->{
        \begin{block}{}
            Permite \textbf{revertir} exactamente los cambios introducidos por un \textit{commit}. Buscamos el \textit{hash} del \textit{commit} en cuestiÃ³n
            usando \texttt{git log}, y luego ejecutamos \texttt{git revert [hash]}.
        \end{block}
    }
\end{frame}

\begin{frame}[t]{Otro comando Ãºtil}
    \begin{comando}
        git stash
    \end{comando}

    \pause
    \begin{block}{}
        Al ejecutar \texttt{git stash}, se guarda el estado actual de los archivos modificados y nos deja el directorio limpio.

        \vspace{0.5em}

        Para volver a mostrar los cambios guardados ejecutamos \texttt{git stash apply}.
    \end{block}
\end{frame}

\begin{frame}[t]{Extras: Ignorando archivos}

    \begin{block}{El archivo .gitignore}
      Es comÃºn tener archivos generados automÃ¡ticamente que no queremos agregar al repositorio. Por ejemplo, archivos compilados: .pdf, .exe, .log, .pyc, etc. Sin embargo, es bastante molesto verlos todo el tiempo al ejecutar \texttt{git status}.

      Para arreglar esto podemos crear un archivo especial llamado \texttt{.gitignore}, que le indica a Git quÃ© archivos \textbf{ignorar} por completo.
    \end{block}

    \pause
    \begin{resumen}{}
      Por ejemplo, para ignorar todos los archivos con extensiÃ³n \textit{.pyc}:
      \begin{enumerate}
        \item Crear un archivo llamado \texttt{.gitignore} en el directorio principal del proyecto.
        \item Adentro escribir: \textit{*.pyc}
      \end{enumerate}
      MÃ¡s ejemplos de \texttt{.gitignore}: \url{https://github.com/github/gitignore}.
    \end{resumen}


\end{frame}

\begin{frame}[t]{Extras: MÃ¡s comandos}

    \begin{itemize}
        \item \texttt{git fetch [remote repository]}: Para traer todos los datos de un repositorio remoto.
        \item \texttt{git reset}: Permite deshacer cambios; sirve para revertir modificaciones en el Ã¡rea de trabajo, pero tambiÃ©n puede eliminar por completo \textit{commits} anteriores. Â¡Usar con mucho cuidado!
        \item \texttt{git rebase [branch]}: Aplica todos los \textit{commits} que difieren entre una rama y aquella en la que estamos parados. AsÃ­ podemos incorporar cambios realizados en otras ramas manteniendo lineal el historial de la rama actual.
        \item \texttt{git blame [archivo]}: Para ver quÃ© \textit{commit} modificÃ³ por Ãºltima vez cada lÃ­nea de un archivo, y quiÃ©n fue su autor. Â¡AsÃ­, podemos saber a quiÃ©n \textit{culpar} cuando haya problemas!
        \item \texttt{git bisect}: Encuentra cuÃ¡l fue el \textit{commit} que introdujo cierto error, haciendo bÃºsqueda binaria en el historial de \textit{commits}.
    \end{itemize}

\end{frame}

\begin{frame}[t]{Extras: Servidores}

    \begin{figure}[ht]
        \begin{center}
            \includegraphics[height=0.7in]{images/github.png}
        \end{center}
    \end{figure}

    \begin{figure}[ht]
        \begin{center}
            \includegraphics[height=0.5in]{images/bitbucket.png}
        \end{center}
    \end{figure}

    \begin{figure}[ht]
        \begin{center}
            \includegraphics[height=0.7in]{images/gitlab.png}
        \end{center}
    \end{figure}

\end{frame}

\begin{frame}[t]{BibliografÃ­a}

    \begin{itemize}
        \item Git Community book, disponible online y en espaÃ±ol: \url{https://git-scm.com/book/es/v2}
        \item \texttt{git help [command]} para ver la documentaciÃ³n de cualquier comando de Git.
        \item A visual Git reference: \url{http://marklodato.github.io/visual-git-guide/index-es.html}
        \item Try Git online: \url{https://try.github.io}
    \end{itemize}

\end{frame}

\begin{frame}{Feedback}

    \begin{center}
        \includegraphics[height=1.5in]{images/octocat-comcom.pdf}
    \end{center}

    \begin{block}{Â¡Nos interesa saber que les pareciÃ³ el taller!}
        Pueden completar el formulario: \url{http://goo.gl/forms/Xg9L1nUC9i}

        \vspace{0.5em}

        TambiÃ©n nos pueden tirar ideas para futuros talleres.
    \end{block}

\end{frame}
